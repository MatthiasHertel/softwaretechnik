%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LaTeX Template: Softwaretechnik SS 2017
%
% Date: April 2017
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt]{article}
\usepackage[a4paper]{geometry}
\usepackage{framed}
\usepackage[myheadings]{fullpage}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{graphicx, wrapfig, subcaption, setspace, booktabs}
\usepackage[T1]{fontenc}
\usepackage[font=small, labelfont=bf]{caption}
\usepackage[protrusion=true, expansion=true]{microtype}
\usepackage[ngerman]{babel}
\usepackage[ngerman]{translator}
\usepackage{sectsty}
\usepackage{url, lipsum}
\usepackage[parfill]{parskip}
\usepackage{csquotes}
\usepackage[hidelinks]{hyperref}
\usepackage[acronym]{glossaries}

\usepackage[sorting=none,backref=true, backend=biber]{biblatex}
\addbibresource{\jobname.bib}
\usepackage[export]{adjustbox}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{float}
\usepackage{pdfpages}


\makeglossaries
\glstoctrue

\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Java,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=left,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}


%-------------------------------------------------------------------------------
% Commands
%-------------------------------------------------------------------------------
\newcommand{\HRule}[1]{\rule{\linewidth}{#1}}
\input{../env}
%-------------------------------------------------------------------------------
% HEADER & FOOTER
%-------------------------------------------------------------------------------
\fancypagestyle{myplain}
{
\fancyhf{}
\paperwidth=\pdfpageheight
\paperheight=\pdfpagewidth
\pdfpageheight=\paperheight
\pdfpagewidth=\paperwidth
\headwidth=\textwidth
\renewcommand\headrulewidth{0pt}
\renewcommand\footrulewidth{0pt}
\fancyfoot[R]{Seite \thepage\ von \pageref{LastPage}}

}

\fancypagestyle{myfancy}{
  \fancyhf{}
  \pagestyle{fancy}
  \fancyhf{}
  \setlength\headheight{15pt}
  \fancyhead[L]{\newCommandName}
  \fancyhead[R]{\newCommandUniversity}
  \fancyfoot[R]{Seite \thepage\ von \pageref{LastPage}}
}

%-------------------------------------------------------------------------------
% TITLE PAGE
%-------------------------------------------------------------------------------
\begin{document}
\hypersetup{
    % colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}


\title{ \normalsize
		\HRule{0.5pt} \\
		\LARGE \textbf{\uppercase{\newCommandDiscipline}} \\
    \smallbreak
    \small\textbf{{TST - Objektorientiertes Testen und Test Driven Development}}\\
		\HRule{2pt} \\ [0.5cm]
    \small\textbf{{\newCommandTerm}}\\
    [0.5cm]
    \normalsize \today \vspace*{10\baselineskip}}

\date{}



\author{
    \newCommandName \\
		\newCommandMatriculationNumber \\
		\newCommandUniversity \\
		\newCommandFaculty
}

% \pagenumbering{gobble}

\maketitle
\thispagestyle{empty}

\newpage

\thispagestyle{myfancy}
\tableofcontents
% \listoffigures
\newpage

%-------------------------------------------------------------------------------
% Section title formatting
\sectionfont{\scshape}
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------
% BODY
%-------------------------------------------------------------------------------

\section{TST - Objektorientiertes Testen und Test Driven Development}
\subsection{ProductController.java}

\begin{lstlisting}
  package de.mhertel.controller;

  import de.mhertel.domain.Product;
  import de.mhertel.service.ProductService;
  import de.mhertel.utility.ProductNotFoundException;
  import org.apache.catalina.servlet4preview.http.HttpServletRequest;
  import org.springframework.beans.factory.annotation.Autowired;
  import org.springframework.stereotype.Controller;
  import org.springframework.ui.Model;
  import org.springframework.ui.ModelMap;
  import org.springframework.web.bind.annotation.ModelAttribute;
  import org.springframework.web.bind.annotation.RequestMapping;
  import org.springframework.web.bind.annotation.RequestMethod;
  import org.springframework.web.bind.annotation.RequestParam;
  import java.util.List;

  /**
   * Created by matthias on 13.05.17.
   */

  @Controller
  @RequestMapping("/products")
  public class ProductController {

      @Autowired
      private ProductService productService;

      @RequestMapping(value = "/list" , method = RequestMethod.GET)
      public String listProducts(ModelMap model) {
          List<Product> productList = productService.findAll();
          model.addAttribute("productList", productList);
          return ("product/list");
      }

      @RequestMapping(value = "/add", method = RequestMethod.GET)
      public String addProduct(Model model) {
          Product product = new Product();
          model.addAttribute("product", product);
          return "product/add";
      }

      @RequestMapping(value = "/add", method = RequestMethod.POST)
      public String addProductPost(@ModelAttribute("product") Product product, HttpServletRequest request) {
          productService.save(product);
          return "redirect:/products/list";
      }

      @RequestMapping("/detail")
      public String productDetail(@RequestParam("id") Long id, ModelMap model) throws Exception{
          Product product = productService.findOne(new Long(id));
          if (product == null) throw new ProductNotFoundException();
          return "product/detail";
      }

      @RequestMapping("/update")
      public String updateProduct(@RequestParam("id") Long id, Model model) {
          Product product = productService.findOne(id);
          model.addAttribute("product", product);
          return "product/update";
      }

      @RequestMapping(value="/update", method=RequestMethod.POST)
      public String updateProductPost(@ModelAttribute("product") Product product, ModelMap model) {
          productService.updateProduct(product);
          model.addAttribute("success", "Product " + product.getTitle()	+ " updated successfully");
          return "redirect:/products/detail?id="+ product.getId();
      }

      @RequestMapping(value="/remove", method=RequestMethod.POST)
      public String removeProduct(@ModelAttribute("id") String id, ModelMap model) {
          productService.removeOne(Long.parseLong(id.substring(11)));
          List<Product> productList = productService.findAll();
          model.addAttribute("productList", productList);
          return "redirect:/products/list";
      }
  }
\end{lstlisting}


%-------------------------------------------------------------------------------
% #1
%-------------------------------------------------------------------------------










%-------------------------------------------------------------------------------
% Literatur - Glossar - Akronyme
%-------------------------------------------------------------------------------

% \clearpage
% \setlength\bibitemsep{10pt}
% \printbibliography[heading=bibintoc]
% \newpage
% \printglossary[type=main,title=Glossar]
% \printglossary[type=\acronymtype, title=Akronyme]


%-------------------------------------------------------------------------------
% ENDE
%-------------------------------------------------------------------------------

\end{document}
